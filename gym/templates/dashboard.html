<!DOCTYPE html>
<html>
<head>
  <title>Gym Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f7fb;
      padding: 30px;
    }
    h1 { margin-bottom: 10px; }
    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,.08);
      margin-bottom: 25px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #eee;
    }
    th { text-align: left; color: #666; }
    .btn {
      background: #667eea;
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      text-decoration: none;
    }
    .btn:hover { background: #556cd6; }
  </style>
</head>
<body>

<h1>üèãÔ∏è Gym Dashboard</h1>
<a class="btn" href="/add">‚ûï Add Member</a>

<div class="card">
  <h3>Members</h3>
  <table>
    <tr>
      <th>ID</th><th>Name</th><th>Phone</th><th>End</th><th>Status</th><th>QR</th>
    </tr>

    {% for m in members %}
    <tr>
      <td>{{ m.member_id }}</td>
      <td>{{ m.name }}</td>
      <td>{{ m.phone }}</td>
      <td>{{ m.end_date }}</td>
      <td>{{ "Active" if m.end_date >= now().strftime("%Y-%m-%d") else "Expired" }}</td>
      <td>
        <a class="btn" href="{{ url_for('generate_qr', member_id=m.member_id) }}" target="_blank">
          View QR
        </a>
      </td>
    </tr>
    {% endfor %}
  </table>
</div>

<div class="card">
  <h3>Attendance (Last 7 Days)</h3>
  <canvas id="chart"></canvas>
</div>

<script>
new Chart(document.getElementById("chart"), {
  type: "line",
  data: {
    labels: {{ chart_dates | safe }},
    datasets: [{
      data: {{ chart_counts | safe }},
      borderColor: "#667eea",
      tension: 0.4,
      fill: false
    }]
  }
});
</script>

</body>
</html>
